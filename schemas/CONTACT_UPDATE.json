{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "CONTACT_UPDATE.json",
  "title": "RemoteID CONTACT_UPDATE Event",
  "allOf": [
    {"$ref": "./EventEnvelope.json"},
    {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": {"const": "CONTACT_UPDATE"},
        "source": {"const": "remoteid"},
        "data": {"$ref": "#/$defs/contact_event"}
      },
      "required": ["type", "timestamp_ms", "source", "data"]
    }
  ],
  "$defs": {
    "contact_event": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "type", "last_seen_ts"],
      "properties": {
        "id": {"type": "string", "minLength": 1},
        "type": {"const": "REMOTE_ID"},
        "model": {"type": "string"},
        "operator_id": {"type": "string"},
        "lat": {"type": "number", "minimum": -90, "maximum": 90},
        "lon": {"type": "number", "minimum": -180, "maximum": 180},
        "altitude_m": {"type": "number"},
        "speed_m_s": {"type": "number", "minimum": 0},
        "last_seen_ts": {"type": "integer", "minimum": 0}
      }
    }
  }
}
